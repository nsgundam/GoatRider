{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///D:/GoatRidder/Frontend/app/homepage/page.js"],"sourcesContent":["\"use client\";\nimport { useState } from \"react\";\nimport { CldImage } from \"next-cloudinary\";\n\nexport default function Welcomepage() {\n  const [error, seterror] = useState(\"\");\n  const [loading, setloading] = useState(false);\n  const [wallet, setwallet] = useState(null);\n  const [showpopup, setshowpopup] = useState(false);\n  const [name, setname] = useState(\"\");\n\n  //-----------------------------------------------------------//\n  // Connect to MetaMask (safe for SSR) \n  async function handleConnectWallet() {\n    seterror(\"\");\n\n    // Protect against server-side execution: window is only available in the browser\n    if (typeof window === \"undefined\") {\n      console.warn(\"handleConnectWallet called on the server. Abort.\");\n      seterror(\"This action must be performed in a browser.\");\n      return;\n    }\n\n    // Now it's safe to read window.ethereum\n    const provider = window?.ethereum;\n    if (!provider) {\n      alert(\"Please install MetaMask\");\n      seterror(\"MetaMask not installed\");\n      return;\n    }\n\n    try {\n      setloading(true);\n      // Request accounts from the provider\n      const accounts = await provider.request({ method: \"eth_requestAccounts\" });\n      if (!accounts || accounts.length === 0) {\n        seterror(\"No accounts returned\");\n        return;\n      }\n      const account = accounts[0];\n      setwallet(account);\n      //------------------------popup------------------------------//\n      setshowpopup(true);\n    } catch (err) {\n      console.error(\"MetaMask connection error:\", err);\n      // userRejectedRequest has code 4001 in many MetaMask versions\n      if (err && err.code === 4001) {\n        seterror(\"User rejected connection\");\n      } else {\n        seterror(\"Failed to connect wallet\");\n      }\n    } finally {\n      setloading(false);\n    }\n  }\n  //-----------------------------------------------------------//\n\n  async function summitname(e) {\n    e.preventDefault();\n    seterror(\"\");\n\n    const trimmed = name.trim();\n    if (!trimmed) {\n      seterror(\"enter your name\");\n      return;\n    }\n    if (!wallet) {\n      seterror(\"no wallet connected\");\n      return;\n    }\n    // สมมมุติว่า fetch เรียบร้อย ไม่มีปัญหา\n    console.log(\"Submitting (frontend test naja):\", { wallet, name: trimmed });\n    // show a simple confirmation and close popup\n    alert(`Welcome, ${trimmed}!\\nWallet: ${wallet}`);\n    setshowpopup(false);\n    setname(\"\");\n  }\n  //-----------------------------------------------------------//\n\n  return (\n    <div className=\"relative w-full h-screen\">\n      <div className=\"absolute inset-0 -z-10 pointer-events-none\">\n        <CldImage\n          src=\"qy3vo3jhmpocodpavgrf\"\n          width={1920}\n          height={1080}\n          className=\"w-full h-full object-cover pointer-events-none\"\n          alt=\"goat rider homepage\"\n        />\n      </div>\n\n      {/* Overlay */}\n      <div className=\"absolute inset-0 flex flex-col items-center justify-center text-center gap-8 px-4 z-20\">\n        {/* Headings */}\n        <h1 className=\"text-5xl md:text-7xl lg:text-[150px] font-bold text-white\">Goat</h1>\n        <h1 className=\"text-5xl md:text-7xl lg:text-[150px] font-bold text-white -mt-6\">Ridder</h1>\n\n        <button\n          onClick={() => {\n            console.log(\"Connect button clicked (debug)\");\n            handleConnectWallet();\n          }}\n          // only disable while loading; let wallet state be shown but not block reconnect attempts\n          disabled={loading}\n          className=\"z-30 pointer-events-auto text-2xl font-normal bg-blue-50 text-black rounded-none hover:bg-blue-100 transition-colors duration-300 px-6 py-3 disabled:opacity-60 disabled:cursor-not-allowed\"\n        >\n          {loading ? \"Connecting...\" : \"Connect Wallet\"}\n        </button>\n\n        {/* error message for quick feedback */}\n        {error && (\n          <div className=\"mt-2 text-red-200 bg-red-900/30 px-3 py-1 rounded-md\">{error}</div>\n        )}\n      </div>\n\n      {/* popup placeholder (if you use) */}\n      {showpopup && (\n        <div className=\"fixed inset-0 z-40 flex items-center justify-center bg-black/50\">\n          <div className=\"bg-white p-6 rounded-md max-w-sm w-full\">\n            <h3 className=\"text-black text-lg font-semibold\">Enter your name</h3>\n            <form onSubmit={summitname} className=\"mt-3\">\n              <input\n                value={name}\n                onChange={(e) => setname(e.target.value)}\n                className=\"w-full px-3 py-2 border rounded-md\"\n                placeholder=\"Your name\"\n              />\n              <div className=\"mt-3 flex justify-end gap-2\">\n                <button type=\"button\" onClick={() => setshowpopup(false)} className=\" text-black px-3 py-2 border rounded-md\">Cancel</button>\n                <button type=\"submit\" className=\"px-3 py-2 bg-blue-600 text-white rounded-md\">Submit</button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Notes:\n// - The important fix: check `typeof window` before accessing `window.ethereum`. That avoids errors during SSR.\n// - Keep pointer-events-none on the background image only; don't put it on a root wrapper.\n// - When debugging MetaMask, open DevTools and watch console logs from the button click and the provider request.\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAIe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IAEjC,+DAA+D;IAC/D,sCAAsC;IACtC,eAAe;QACb,SAAS;QAET,iFAAiF;QACjF,wCAAmC;YACjC,QAAQ,IAAI,CAAC;YACb,SAAS;YACT;QACF;;;QAEA,wCAAwC;QACxC,MAAM;IA8BR;IACA,+DAA+D;IAE/D,eAAe,WAAW,CAAC;QACzB,EAAE,cAAc;QAChB,SAAS;QAET,MAAM,UAAU,KAAK,IAAI;QACzB,IAAI,CAAC,SAAS;YACZ,SAAS;YACT;QACF;QACA,IAAI,CAAC,QAAQ;YACX,SAAS;YACT;QACF;QACA,wCAAwC;QACxC,QAAQ,GAAG,CAAC,oCAAoC;YAAE;YAAQ,MAAM;QAAQ;QACxE,6CAA6C;QAC7C,MAAM,CAAC,SAAS,EAAE,QAAQ,WAAW,EAAE,QAAQ;QAC/C,aAAa;QACb,QAAQ;IACV;IACA,+DAA+D;IAE/D,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,gKAAQ;oBACP,KAAI;oBACJ,OAAO;oBACP,QAAQ;oBACR,WAAU;oBACV,KAAI;;;;;;;;;;;0BAKR,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAG,WAAU;kCAA4D;;;;;;kCAC1E,8OAAC;wBAAG,WAAU;kCAAkE;;;;;;kCAEhF,8OAAC;wBACC,SAAS;4BACP,QAAQ,GAAG,CAAC;4BACZ;wBACF;wBACA,yFAAyF;wBACzF,UAAU;wBACV,WAAU;kCAET,UAAU,kBAAkB;;;;;;oBAI9B,uBACC,8OAAC;wBAAI,WAAU;kCAAwD;;;;;;;;;;;;YAK1E,2BACC,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAmC;;;;;;sCACjD,8OAAC;4BAAK,UAAU;4BAAY,WAAU;;8CACpC,8OAAC;oCACC,OAAO;oCACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;oCACvC,WAAU;oCACV,aAAY;;;;;;8CAEd,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAO,MAAK;4CAAS,SAAS,IAAM,aAAa;4CAAQ,WAAU;sDAA0C;;;;;;sDAC9G,8OAAC;4CAAO,MAAK;4CAAS,WAAU;sDAA8C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ9F,EAEA,SAAS;CACT,gHAAgH;CAChH,2FAA2F;CAC3F,kHAAkH"}}]
}