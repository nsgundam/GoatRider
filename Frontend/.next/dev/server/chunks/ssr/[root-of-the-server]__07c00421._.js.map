{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///D:/GoatRidder/Frontend/app/homepage/page.js"],"sourcesContent":["\"use client\";\r\nimport { useState } from \"react\";\r\nimport { CldImage } from \"next-cloudinary\";\r\n\r\nexport default function Welcomepage() {\r\n  const [error, seterror] = useState(\"\");\r\n  const [loading, setloading] = useState(false);\r\n  const [wallet, setwallet] = useState(null);\r\n  const [showpopup, setshowpopup] = useState(false);\r\n  const [name, setname] = useState(\"\");\r\n\r\n  //-----------------------------------------------------------//\r\n  // Connect to MetaMask (safe for SSR) \r\n  async function handleConnectWallet() {\r\n    seterror(\"\");\r\n\r\n    // Protect against server-side execution: window is only available in the browser\r\n    if (typeof window === \"undefined\") {\r\n      console.warn(\"handleConnectWallet called on the server. Abort.\");\r\n      seterror(\"This action must be performed in a browser.\");\r\n      return;\r\n    }\r\n\r\n    // Now it's safe to read window.ethereum\r\n    const provider = window?.ethereum;\r\n    if (!provider) {\r\n      alert(\"Please install MetaMask\");\r\n      seterror(\"MetaMask not installed\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setloading(true);\r\n      // Request accounts from the provider\r\n      const accounts = await provider.request({ method: \"eth_requestAccounts\" });\r\n      if (!accounts || accounts.length === 0) {\r\n        seterror(\"No accounts returned\");\r\n        return;\r\n      }\r\n      const account = accounts[0];\r\n      setwallet(account);\r\n      //------------------------popup------------------------------//\r\n      setshowpopup(true);\r\n    } catch (err) {\r\n      console.error(\"MetaMask connection error:\", err);\r\n      // userRejectedRequest has code 4001 in many MetaMask versions\r\n      if (err && err.code === 4001) {\r\n        seterror(\"User rejected connection\");\r\n      } else {\r\n        seterror(\"Failed to connect wallet\");\r\n      }\r\n    } finally {\r\n      setloading(false);\r\n    }\r\n  }\r\n  //-----------------------------------------------------------//\r\n\r\n  async function summitname(e) {\r\n    e.preventDefault();\r\n    seterror(\"\");\r\n\r\n    const trimmed = name.trim();\r\n    if (!trimmed) {\r\n      seterror(\"enter your name\");\r\n      return;\r\n    }\r\n    if (!wallet) {\r\n      seterror(\"no wallet connected\");\r\n      return;\r\n    }\r\n    // สมมมุติว่า fetch เรียบร้อย ไม่มีปัญหา\r\n    console.log(\"Submitting (frontend test naja):\", { wallet, name: trimmed });\r\n    // show a simple confirmation and close popup\r\n    alert(`Welcome, ${trimmed}!\\nWallet: ${wallet}`);\r\n    setshowpopup(false);\r\n    setname(\"\");\r\n  }\r\n  //-----------------------------------------------------------//\r\n\r\n  return (\r\n    <div className=\"relative w-full h-screen\">\r\n      <div className=\"absolute inset-0 -z-10 pointer-events-none\">\r\n        <CldImage\r\n          src=\"qy3vo3jhmpocodpavgrf\"\r\n          width={1920}\r\n          height={1080}\r\n          className=\"w-full h-full object-cover pointer-events-none\"\r\n          alt=\"goat rider homepage\"\r\n        />\r\n      </div>\r\n\r\n      {/* Overlay */}\r\n      <div className=\"absolute inset-0 flex flex-col items-center justify-center text-center gap-8 px-4 z-20\">\r\n        {/* Headings */}\r\n        <h1 className=\"text-5xl md:text-7xl lg:text-[150px] font-bold text-white\">Goat</h1>\r\n        <h1 className=\"text-5xl md:text-7xl lg:text-[150px] font-bold text-white -mt-6\">Ridder</h1>\r\n\r\n        <button\r\n          onClick={() => {\r\n            console.log(\"Connect button clicked (debug)\");\r\n            handleConnectWallet();\r\n          }}\r\n          // only disable while loading; let wallet state be shown but not block reconnect attempts\r\n          disabled={loading}\r\n          className=\"z-30 pointer-events-auto text-2xl font-normal bg-blue-50 text-black rounded-none hover:bg-blue-100 transition-colors duration-300 px-6 py-3 disabled:opacity-60 disabled:cursor-not-allowed\"\r\n        >\r\n          {loading ? \"Connecting...\" : \"Connect Wallet\"}\r\n        </button>\r\n\r\n        {/* error message for quick feedback */}\r\n        {error && (\r\n          <div className=\"mt-2 text-red-200 bg-red-900/30 px-3 py-1 rounded-md\">{error}</div>\r\n        )}\r\n      </div>\r\n\r\n      {/* popup placeholder (if you use) */}\r\n      {showpopup && (\r\n        <div className=\"fixed inset-0 z-40 flex items-center justify-center bg-black/50\">\r\n          <div className=\"bg-white p-6 rounded-md max-w-sm w-full\">\r\n            <h3 className=\"text-black text-lg font-semibold\">Enter your name</h3>\r\n            <form onSubmit={summitname} className=\"mt-3\">\r\n              <input\r\n                value={name}\r\n                onChange={(e) => setname(e.target.value)}\r\n                className=\"w-full px-3 py-2 border rounded-md\"\r\n                placeholder=\"Your name\"\r\n              />\r\n              <div className=\"mt-3 flex justify-end gap-2\">\r\n                <button type=\"button\" onClick={() => setshowpopup(false)} className=\" text-black px-3 py-2 border rounded-md\">Cancel</button>\r\n                <button type=\"submit\" className=\"px-3 py-2 bg-blue-600 text-white rounded-md\">Submit</button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Notes:\r\n// - The important fix: check `typeof window` before accessing `window.ethereum`. That avoids errors during SSR.\r\n// - Keep pointer-events-none on the background image only; don't put it on a root wrapper.\r\n// - When debugging MetaMask, open DevTools and watch console logs from the button click and the provider request.\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAIe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IAEjC,+DAA+D;IAC/D,sCAAsC;IACtC,eAAe;QACb,SAAS;QAET,iFAAiF;QACjF,wCAAmC;YACjC,QAAQ,IAAI,CAAC;YACb,SAAS;YACT;QACF;;;QAEA,wCAAwC;QACxC,MAAM;IA8BR;IACA,+DAA+D;IAE/D,eAAe,WAAW,CAAC;QACzB,EAAE,cAAc;QAChB,SAAS;QAET,MAAM,UAAU,KAAK,IAAI;QACzB,IAAI,CAAC,SAAS;YACZ,SAAS;YACT;QACF;QACA,IAAI,CAAC,QAAQ;YACX,SAAS;YACT;QACF;QACA,wCAAwC;QACxC,QAAQ,GAAG,CAAC,oCAAoC;YAAE;YAAQ,MAAM;QAAQ;QACxE,6CAA6C;QAC7C,MAAM,CAAC,SAAS,EAAE,QAAQ,WAAW,EAAE,QAAQ;QAC/C,aAAa;QACb,QAAQ;IACV;IACA,+DAA+D;IAE/D,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,gKAAQ;oBACP,KAAI;oBACJ,OAAO;oBACP,QAAQ;oBACR,WAAU;oBACV,KAAI;;;;;;;;;;;0BAKR,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAG,WAAU;kCAA4D;;;;;;kCAC1E,8OAAC;wBAAG,WAAU;kCAAkE;;;;;;kCAEhF,8OAAC;wBACC,SAAS;4BACP,QAAQ,GAAG,CAAC;4BACZ;wBACF;wBACA,yFAAyF;wBACzF,UAAU;wBACV,WAAU;kCAET,UAAU,kBAAkB;;;;;;oBAI9B,uBACC,8OAAC;wBAAI,WAAU;kCAAwD;;;;;;;;;;;;YAK1E,2BACC,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAmC;;;;;;sCACjD,8OAAC;4BAAK,UAAU;4BAAY,WAAU;;8CACpC,8OAAC;oCACC,OAAO;oCACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;oCACvC,WAAU;oCACV,aAAY;;;;;;8CAEd,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAO,MAAK;4CAAS,SAAS,IAAM,aAAa;4CAAQ,WAAU;sDAA0C;;;;;;sDAC9G,8OAAC;4CAAO,MAAK;4CAAS,WAAU;sDAA8C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ9F,EAEA,SAAS;CACT,gHAAgH;CAChH,2FAA2F;CAC3F,kHAAkH"}}]
}